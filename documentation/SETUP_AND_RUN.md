# Установка и запуск MGCOM Finance AI

## 1. Требования к окружению

- **Node.js**: версия 20+ (рекомендуется последняя LTS).
- **npm**: идёт вместе с Node.js.
- Доступ в интернет для установки пакетов и обращения к YandexGPT (если настраиваете реальную интеграцию).

Проверка версий:

```bash
node -v
npm -v
```

## 2. Установка зависимостей

Перейдите в папку фронтенд‑приложения:

```bash
cd web
npm install
```

Команда установит все зависимости, указанные в `web/package.json`:

- `next` — фреймворк;
- `react`, `react-dom` — фронтенд;
- `@supabase/supabase-js` — клиент для работы с БД Supabase;
- dev‑зависимости для TypeScript, ESLint и Tailwind CSS.

## 3. Переменные окружения (YandexGPT)

Для полноценной работы чата с ИИ необходимо настроить доступ к **YandexGPT**.

В папке `web` создайте файл `.env.local` (он не должен попадать в git) и пропишите:

```bash
YANDEX_GPT_API_KEY=ваш_api_ключ
YANDEX_GPT_FOLDER_ID=ваш_folder_id
# Опционально, если нужен конкретный URI модели, иначе возьмётся latest:
YANDEX_GPT_MODEL_URI=gpt://<folder-id>/yandexgpt/latest
```

Если эти переменные **не заданы**, маршрут `/api/chat` работает в режиме **заглушки**:

- возвращает тестовое сообщение;
- отдаёт фиксированный `tableRequest` для таблицы `clients`.

Это удобно для разработки UI без внешних интеграций.

## 4. Локальный запуск в режиме разработки

Из папки `web` выполните:

```bash
npm run dev
```

После запуска:

- Откройте в браузере `http://localhost:3000`.
- Вы увидите:
  - верхнюю панель с логотипом и переключателем темы;
  - основное поле с таблицей;
  - правую панель чата с ИИ.

При изменении файлов в `src/` интерфейс будет автоматически перезагружаться (Hot Reload).

## 5. Сборка и продакшен‑режим

### 5.1. Сборка

```bash
cd web
npm run build
```

Команда выполняет оптимизированную сборку Next.js:

- компиляция TypeScript;
- оптимизация бандла;
- подготовка серверных роутов.

### 5.2. Запуск собранной версии

После успешной сборки:

```bash
npm run start
```

По умолчанию приложение стартует на `http://localhost:3000` в продакшен‑режиме.

## 6. Работа с данными (Supabase)

Рабочие данные приложения хранятся в БД Supabase (PostgreSQL) в таблицах вроде:

- `clients` — клиенты;
- `contacts` — контакты;
- `tenders` — тендеры.

Приложение обращается к этим таблицам через маршрут `/api/data`, который внутри использует Supabase‑клиент.  
Импорт из Excel/выгрузок (если нужен) выполняется как отдельный процесс (скрипт, админ‑операция) и **не является частью рантайма Next.js**.

## 7. Типичный рабочий цикл разработчика

1. Клонировать репозиторий и перейти в корень проекта.
2. Настроить Node.js и npm.
3. Установить зависимости в `web`:
   - `npm install`.
4. При необходимости — настроить `.env.local` для YandexGPT.
5. Запустить dev‑сервер:
   - `npm run dev` и открыть `http://localhost:3000`.
6. Вносить изменения в компоненты (`src/components`) и API (`src/app/api`).
7. Перед выкатыванием в тест/прод:
   - `npm run build` и `npm run start` для проверки продакшен‑режима.

